<!DOCTYPE html>
<html>
<head>
    <title>Language Translator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <style>
        .dropdown-content {
            display: none;
            position: absolute;
            z-index: 10;
        }
        .dropdown:hover .dropdown-content {
            display: block;
        }
    </style>
</head>
<body class="bg-gray-800 flex flex-col items-center justify-center min-h-screen">
    <div class="w-full max-w-4xl">
        <div class="flex justify-between items-center mb-4">
            <button class="text-white text-2xl">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h1 class="text-white text-3xl font-bold">LANGUAGE TRANSLATOR</h1>
            <div></div>
        </div>
        <div class="flex justify-between items-start">
            <!-- Source Language Section -->
            <div class="flex flex-col items-center">
                <!-- Source Language Dropdown -->
                <div class="relative dropdown">
                    <button id="sourceLanguageButton" class="bg-white text-black font-semibold py-2 px-4 rounded-full shadow-md flex items-center">
                        <span id="sourceLanguage">Select language</span> <i class="fas fa-caret-down ml-2"></i>
                    </button>
                    <div class="absolute mt-2 w-40 bg-white rounded-md shadow-lg dropdown-content">
                        <ul class="py-1">
                            <li class="px-4 py-2 text-black font-bold cursor-pointer hover:bg-gray-200" onclick="selectLanguage('source', 'auto', 'Auto Detect')">Auto Detect</li>
                            <li class="px-4 py-2 text-black font-bold cursor-pointer hover:bg-gray-200" onclick="selectLanguage('source', 'en', 'English')">English</li>
                            <li class="px-4 py-2 text-black font-bold cursor-pointer hover:bg-gray-200" onclick="selectLanguage('source', 'zh', 'Mandarin')">Mandarin</li>
                            <li class="px-4 py-2 text-black font-bold cursor-pointer hover:bg-gray-200" onclick="selectLanguage('source', 'ms', 'Malay')">Malay</li>
                        </ul>
                    </div>
                </div>
                <!-- Source Textarea -->
                <div class="mt-4 bg-white w-64 h-96 rounded-lg shadow-md p-4">
                    <textarea id="sourceText" class="w-full h-full bg-transparent outline-none resize-none" placeholder="Enter text here..."></textarea>
                </div>
            </div>
            <!-- Middle Section -->
            <div class="flex flex-col items-center mx-4">
                <button id="translateButton" onclick="translateText()" class="bg-white text-black font-semibold py-2 px-4 rounded-full shadow-md">
                    TRANSLATE
                </button>
            </div>
            <!-- Target Language Section -->
            <div class="flex flex-col items-center">
                <!-- Target Language Dropdown -->
                <div class="relative dropdown">
                    <button id="targetLanguageButton" class="bg-white text-black font-semibold py-2 px-4 rounded-full shadow-md flex items-center">
                        <span id="targetLanguage">Select language</span> <i class="fas fa-caret-down ml-2"></i>
                    </button>
                    <div class="absolute mt-2 w-40 bg-white rounded-md shadow-lg dropdown-content">
                        <ul class="py-1">
                            <li class="px-4 py-2 text-black font-bold cursor-pointer hover:bg-gray-200" onclick="selectLanguage('target', 'en', 'English')">English</li>
                            <li class="px-4 py-2 text-black font-bold cursor-pointer hover:bg-gray-200" onclick="selectLanguage('target', 'zh', 'Mandarin')">Mandarin</li>
                            <li class="px-4 py-2 text-black font-bold cursor-pointer hover:bg-gray-200" onclick="selectLanguage('target', 'ms', 'Malay')">Malay</li>
                        </ul>
                    </div>
                </div>
                <!-- Target Textarea -->
                <div class="mt-4 bg-white w-64 h-96 rounded-lg shadow-md p-4">
                    <textarea id="targetText" class="w-full h-full bg-transparent outline-none resize-none" readonly></textarea>
                </div>
            </div>
        </div>
    </div>

    <script>
        let sourceLang = 'auto';  // Default source language (auto-detection)
        let targetLang = '';  // Empty target language (to be set by user)

        function selectLanguage(type, code, displayName) {
            if (type === 'source') {
                sourceLang = code;  // Set the source language based on user selection
                document.getElementById('sourceLanguage').innerText = displayName;  // Update the display text
            } else if (type === 'target') {
                targetLang = code;  // Set the target language based on user selection
                document.getElementById('targetLanguage').innerText = displayName;  // Update the display text
            }
        }

        async function translateText() {
            const text = document.getElementById('sourceText').value.trim();
            if (!text) {
                alert('Please enter text to translate.');
                return;  // Stop if no text is entered
            }
            if (!targetLang) {
                alert('Please select a target language.');
                return;  // Stop if no target language is selected
            }

            try {
                // Make a POST request to the Flask backend
                const res = await fetch('http://127.0.0.1:5000/translate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        text: text,               // Input text from user
                        source: sourceLang,        // Source language selected
                        target: targetLang         // Target language selected
                    })
                });

                const data = await res.json();  // Parse the JSON response
                console.log(data);  // Log the response to check

                // Check if 'translatedText' exists in the response and update the target textarea
                if (data.translatedText) {
                    document.getElementById('targetText').value = data.translatedText;
                } else {
                    document.getElementById('targetText').value = 'Translation error';  // If no translation found, display error
                }
            } catch (error) {
                console.error(error);
                alert('An error occurred during translation.');
            }
        }
    </script>
</body>
</html>

